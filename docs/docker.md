## Docker Local Setup

Docker can be used to setup a local development environment:

- Ensure Docker is installed ([Docker Desktop](https://www.docker.com/products/docker-desktop) is a good option for developers)
- From the root of this project, run `docker-compose up -d`
- Once <http://localhost:8082> displays the WordPress install screen, run `./bin/docker-setup.sh`
- The fully configured site can now be accessed on <http://localhost:8082>
- The prompt to run the setup wizard can be dismissed unless there is something specific you would like to configure

To shutdown:

- Use `docker-compose down` to stop the running containers
- The state of the environment will be persisted in `docker/wordpress` and `docker/data`. To restart the environment simply run `docker-compose up -d` again. To start afresh, delete these folders and let `docker-compose up` re-create them.

### Note on docker port forwarding

Mapping to port 80 for `woocommerce_square_wordpress` container is made intentionally to make sure loopback test connection checks are passed by the plugin when `http://localhost` is used as a site URL.

In case port 80 is busy on a host machinge and cannot be freed up the following workaround is possible with http tunneling tool:

1. Install http tunnel tool like [ngrok](https://ngrok.com/).
2. Change port mapping for `woocommerce_square_wordpress` container in `docker-compose.yml` to something different:
```
ports:
      - "8082:80"
```
3. Restart containers by running `docker-compose down && docker-compose up -d`.
4. Start http tunnel: `ngrok http 8082`. If paid version of ngrok is used you can specify a domain name by passing `subdomain` arg: `ngrok http 8082 -subdomain mycusomtsubdomain` to access the site with `http://mycusomtsubdomain.ngrok.io`.
5. Access local site with http url generated by ngrok.
